<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3BBTV</title>
    <script src="https://ssl.p.jwpcdn.com/player/v/8.26.0/jwplayer.js"></script>
    <script>
        jwplayer.key = 'XSuP4qMl+9tK17QNb+4+th2Pm9AWgMO/cYH8CI0HGGr7bdjo';
    </script>
    <style>
        body {
            margin: 0;
            padding: 0;
            background-color: #000;
            color: #fff;
            font-family: Arial, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        #player {
            width: 100%;
            max-width: 100%;
            aspect-ratio: 16/9; /* ทำให้วิดีโอรักษาสัดส่วน */
        }
        #channel-list {
            margin: 10px auto;
            max-width: 800px;
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            justify-content: center;
        }
        .channel {
            cursor: pointer;
            padding: 5px;
            background: #222;
            border: 1px solid #444;
            border-radius: 5px;
            text-align: center;
            width: 50px;
        }
        .channel img {
            width: 50px;
            height: 50px;
            margin-bottom: 5px;
        }
        .channel:hover {
            background: #000;
        }
        /* Style for the Wiseplay button */
        .wiseplay-btn {
            display: block;
            margin-top: 5px; /* ลดระยะห่างลงเล็กน้อย */
            padding: 5px; /* ลดขนาดปุ่มลง */
            background-color: #4CAF50;
            color: white;
            text-align: center;
            text-decoration: none;
            border-radius: 3px; /* ลดรัศมีขอบ */
            font-size: 12px; /* ลดขนาดตัวอักษร */
            cursor: pointer;
        }
        .wiseplay-btn:hover {
            background-color: #45a049;
        }
    </style>
</head>
<body>
    <div id="player"></div>
    <div id="channel-list"></div>
    <button id="startPlayback" style="padding: 10px 20px; font-size: 16px; margin-top: 20px;">เริ่มเล่นในเบราว์เซอร์</button>

    <script>
        const channels = [
            {
                name: "ช่อง 3 HD (HLS)",
                logo: "https://dookeela.live/uploads/1685812254.png", // โลโก้ตัวอย่าง
                // **สำคัญ: URL นี้มีอายุจำกัดและอาจต้องมีการดึงใหม่บ่อยๆ**
                file: "https://dkl-o53d.cdn.akamaiz.com/dookeela/ch3hd/chunks.m3u8?nimblesessionid=39073334&wmsAuthSign=c2VydmVyX3RpbWU9Ni8zMC8yMDI1IDM6MTU6MTcgQU0maGFzaF92YWx1ZT1PWllTak5jRFhybmNFeDRFTFlNTjd3PT0mdmFsaWRtaW51dGVzPTEmaWQ9MTg0MmQzMGQwN2Y0ZjYxMmYyZWE5ZWEwNWM2NzM1MzUmY2hlY2tpcD10cnVlJnN0cm1fbGxlbj0xNA",
                type: "hls"
            },
            {
                name: "Channel 5 (DASH)",
                logo: "https://ais-s.ais-vidnt.com/.../channelicon/ch5new.logo.png",
                file: "https://cri-streamer3.cdn.3bbtv.com:8443/3bb/live/5/5.mpd",
                type: "dash",
                keyId: "87db4361f7894655a4656e9c8b935a02",
                key: "b025a4b950df41158a87cfc8d6f2ac34"
            },
            {
                name: "Test True Film 2",
                logo: "https://dookeela.live/uploads/1720723122.png",
                file: "https://goal-th.com/ช่องรายการทีวี/?id=420&tv=TrueFilm2",
                type: "hls"
            },
            // เพิ่มช่องอื่นๆ ของคุณที่นี่
        ];

        function loadPlayer(channel) {
            const playerConfig = {
                file: channel.file,
                type: channel.type,
                width: "100%",
                aspectratio: "16:9",
                autostart: true,
                mute: false
            };

            if (channel.type === "dash" && channel.keyId && channel.key) {
                playerConfig.drm = {
                    clearkey: {
                        keyId: channel.keyId,
                        key: channel.key
                    }
                };
            }

            jwplayer("player").setup(playerConfig);
        }

        const channelList = document.getElementById("channel-list");
        channels.forEach(channel => {
            const div = document.createElement("div");
            div.className = "channel";

            // สร้าง Wiseplay Intent URI
            // การเข้ารหัส URI component ให้ถูกต้องเป็นสิ่งสำคัญสำหรับ URL ของไฟล์
            const encodedFileUrl = encodeURIComponent(channel.file);
            const wiseplayIntentUri = `intent://${channel.name.replace(/ /g, '_')}#Intent;package=com.wiseplay;S.url=${encodedFileUrl};S.title=${encodeURIComponent(channel.name)};scheme=https;type=video/mp4;end`;

            div.innerHTML = `
                <img src="${channel.logo}" alt="${channel.name}"><br>
                ${channel.name}
                <a href="${wiseplayIntentUri}" class="wiseplay-btn" target="_blank">เปิดใน Wiseplay</a>
            `;
            // เมื่อคลิกที่ div ให้เล่นใน JW Player ยกเว้นถ้าคลิกที่ปุ่ม Wiseplay
            div.onclick = (e) => {
                if (!e.target.classList.contains('wiseplay-btn')) {
                    loadPlayer(channel);
                }
            };
            channelList.appendChild(div);
        });

        document.getElementById("startPlayback").onclick = () => {
            loadPlayer(channels[0]); // โหลดช่องแรกใน JW Player
            document.getElementById("startPlayback").style.display = "none";
        };
    </script>
</body>
</html>
