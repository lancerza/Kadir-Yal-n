<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="ทีวีออนไลน์ รวมลิงก์ดูทีวี กีฬา และหนังออนไลน์ในที่เดียว">
    <meta name="keywords" content="ทีวีออนไลน์, ดูหนัง, กีฬา, YouTube">
    <title>ทีวีออนไลน์ ดูฟรีไม่เสียรายเดือน</title>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@400;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">

    <link rel="icon" type="image/x-icon" href="/images/favicon.ico">
    <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">

    <script async src="https://www.googletagmanager.com/gtag/js?id=G-KBRV24KW7F"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-KBRV24KW7F');
    </script>

    <style>
        :root {
            --dark-bg: #1a1a1a;
            --light-text: #f0f0f0;
            --white: #FFFFFF;
            --red-accent: #ff4d4d;
            --line-blue: #2196F3;
            --line-green: #00B900;
            --border-radius: 8px;
            --spacing-xs: 5px;
            --spacing-sm: 8px;
            --spacing-md: 10px;
            --spacing-lg: 15px;
            --spacing-xl: 20px;
        }

        /* Animation for header (Fade in) */
        @keyframes fadeIn {
            0% { opacity: 0; }
            100% { opacity: 1; }
        }

        /* Animation for running text */
        @keyframes marquee {
            0% { transform: translateX(100%); } /* Start from right */
            100% { transform: translateX(-100%); } /* Go to far left */
        }

        html, body {
            margin: 0;
            padding: 0 var(--spacing-md);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            overflow-x: hidden;
            background-color: var(--dark-bg);
            color: var(--light-text);
            font-family: 'Arial', sans-serif;
            text-align: center;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        header {
            background-color: var(--dark-bg);
            color: var(--white);
            padding: 2vw 4vw;
            border-radius: var(--border-radius);
            margin: 5vh 0 2vh 0;
            animation: fadeIn 3s ease-out;
            width: 100%;
            box-sizing: border-box;
            border: 2px solid var(--dark-bg);
            box-shadow: none;
            overflow: hidden;
        }

        #running-text-container {
            width: 100%;
            margin-bottom: var(--spacing-xs);
            position: relative;
            height: 20px;
            overflow: hidden;
        }

        #running-text {
            display: inline-block;
            white-space: nowrap;
            color: var(--red-accent);
            font-family: 'Kanit', sans-serif;
            font-size: clamp(12px, 2vw, 16px);
            font-weight: 700;
            animation: marquee 15s linear infinite;
            position: absolute;
            top: 0;
            left: 0;
            min-width: 100%;
            cursor: default;
        }

        h1 {
            color: var(--white);
            text-align: center;
            font-family: 'Kanit', sans-serif;
            font-size: clamp(24px, 5vw, 40px);
            font-weight: 900;
            letter-spacing: 2px;
            text-shadow: 0 0 8px rgba(255, 255, 255, 0.4), 0 0 12px rgba(255, 255, 255, 0.2);
            margin-top: 1px;
            margin-bottom: var(--spacing-md);
        }

        #current-datetime {
            font-family: 'Kanit', sans-serif;
            font-size: clamp(14px, 2.5vw, 20px);
            color: rgba(255, 255, 255, 0.8);
            margin-top: var(--spacing-md);
            margin-bottom: var(--spacing-md);
            text-shadow: 0 0 5px rgba(255, 255, 255, 0.3);
            font-weight: 400;
        }

        #line-group-info {
            font-family: 'Kanit', sans-serif;
            font-size: clamp(14px, 2.5vw, 20px);
            color: var(--line-blue);
            margin-top: var(--spacing-md);
            margin-bottom: var(--spacing-xl);
            text-shadow: 0 0 5px rgba(0, 0, 0, 0.3);
            font-weight: 700;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            text-decoration: none;
        }

        #line-group-info:hover {
            color: #1976D2;
        }

        #line-group-info i {
            font-size: 25px;
            vertical-align: middle;
            color: var(--line-green);
        }

        #line-group-info i.fa-brands.fa-line.left-icon {
            margin-right: var(--spacing-sm);
        }

        #line-group-info i.fa-brands.fa-line.right-icon {
            margin-left: var(--spacing-sm);
        }

        main.categories-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: var(--spacing-lg);
            width: 100%;
            max-width: 1200px;
            margin-top: clamp(30px, 6vw, 50px);
            padding-bottom: var(--spacing-md);
            flex-grow: 1;
            align-items: flex-start; /* Ensure items align to the top */
        }

        .category {
            background-color: var(--dark-bg);
            border-radius: var(--border-radius);
            padding: var(--spacing-xs);
            flex: 0 0 auto;
            width: 220px;
            box-sizing: border-box;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            border: 1px solid var(--dark-bg);
            height: auto;
            box-shadow: none;
        }

        .category:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        @media (max-width: 768px) {
            .categories-container {
                gap: var(--spacing-md);
            }
            .category {
                width: calc(50% - 15px);
                max-width: unset;
            }
        }

        @media (max-width: 480px) {
            .categories-container {
                gap: var(--spacing-md);
                padding: 0 var(--spacing-xs) var(--spacing-md) var(--spacing-xs);
            }
            .category {
                width: calc(100% - 10px);
                margin-left: auto;
                margin-right: auto;
            }
        }

        .accordion-button {
            background: linear-gradient(145deg, #424242, #333333);
            color: var(--white);
            font-family: 'Kanit', sans-serif;
            font-size: 1.3em;
            font-weight: bold;
            padding: 7px 14px;
            border-radius: var(--border-radius);
            cursor: pointer;
            width: 100%;
            text-align: center;
            margin-bottom: 0;
            transition: background 0.3s ease, transform 0.2s ease, box-shadow 0.3s ease, border-color 0.3s ease;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.5);
            box-sizing: border-box;
            border: 1px solid var(--white);
            box-shadow: 0 0 5px rgba(255, 255, 255, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .accordion-button:hover {
            background: linear-gradient(145deg, #616161, #505050);
            transform: translateY(-3px);
            box-shadow: 0 0 15px rgba(255, 255, 255, 0.8), 0 0 20px rgba(255, 255, 255, 0.6);
            border-color: var(--white);
        }

        .accordion-button:active {
            transform: translateY(0);
            box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.5);
            background: #333333;
            border-color: #AAAAAA;
        }

        .accordion-button i {
            margin-right: var(--spacing-sm);
            color: rgba(255, 255, 255, 0.8);
        }

        .accordion-content {
            max-height: 0;
            padding: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out, padding 0.3s ease-out, opacity 0.3s ease-out;
            display: none;
            opacity: 0;
            width: 100%;
            flex-wrap: wrap;
            justify-content: center;
            gap: var(--spacing-sm);
        }

        .accordion-content.show {
            display: flex;
            opacity: 1;
            padding-top: var(--spacing-sm);
            padding-bottom: var(--spacing-sm);
        }

        main img {
            border-radius: var(--border-radius);
            border: 1px solid var(--white);
            padding: 3px;
            margin: 0;
            height: 50px;
            width: 50px;
            object-fit: cover;
            vertical-align: middle;
            transition: transform 0.2s ease, box-shadow 0.2s ease, border-color 0.2s ease;
            cursor: pointer;
        }

        main img:hover {
            transform: scale(1.05);
            border-color: var(--white);
            box-shadow: 0 0 15px rgba(255, 255, 255, 0.7), 0 0 20px rgba(255, 255, 255, 0.5);
        }

        footer {
            margin-top: auto;
            padding: var(--spacing-xl);
            color: var(--light-text);
            background-color: var(--dark-bg);
            width: 100%;
            text-align: center;
            border-top: none;
        }
    </style>
</head>
<body>
    <header>
        <div id="running-text-container">
            <div id="running-text">
                แอปดูฟรี ไม่เสียรายเดือน! อนุญาตให้ใช้เพื่อความบันเทิงในที่พักอาศัยเท่านั้น ห้ามนำไปหลอกขายคนอื่น !!!
            </div>
        </div>
        <h1>เชิญดูฟรีไม่เสียรายเดือน</h1>
        <time id="current-datetime" aria-live="polite"></time>
        <a href="https://line.me/ti/g2/7xI-GwYG_G9qyuLqXhj79IwFj4Gv1-6boc5DuA?utm_source=invitation&utm_medium=link_copy&utm_campaign=default" id="line-group-info" target="_blank" rel="noopener noreferrer">
            <i class="fa-brands fa-line left-icon"></i> เข้ากลุ่มไลน์อัพเดทต่างๆ
            <i class="fa-brands fa-line right-icon"></i>
        </a>
    </header>

    <main class="categories-container">
        <div class="category">
            <button class="accordion-button" aria-expanded="false" aria-controls="content-thai-tv">
                <i class="fas fa-tv"></i> ทีวีดิจิตอล
            </button>
            <div id="content-thai-tv" class="accordion-content">
            </div>
        </div>

        <div class="category">
            <button class="accordion-button" aria-expanded="false" aria-controls="content-sport">
                <i class="fas fa-running"></i> กีฬา
            </button>
            <div id="content-sport" class="accordion-content">
            </div>
        </div>

        <div class="category">
            <button class="accordion-button" aria-expanded="false" aria-controls="content-movies">
                <i class="fas fa-film"></i> หนังทีวี
            </button>
            <div id="content-movies" class="accordion-content">
            </div>
        </div>

        <div class="category">
            <button class="accordion-button" aria-expanded="false" aria-controls="content-iptv">
                <i class="fas fa-network-wired"></i> IPTV
            </button>
            <div id="content-iptv" class="accordion-content">
            </div>
        </div>
    </main>

    <footer>
        <p>© Copyright 2025 DonOk Co Ltd.</p>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Get the element to display current date and time
            const datetimeDisplay = document.getElementById('current-datetime');

            // Map category names to their respective accordion content elements
            // IMPORTANT: Ensure these keys match the 'category' property in your channels.json
            // and the innerText of your accordion buttons.
            const categoryContentMap = {
                "ทีวีดิจิตอล": document.getElementById('content-thai-tv'),
                "กีฬา": document.getElementById('content-sport'),
                "หนังทีวี": document.getElementById('content-movies'),
                "IPTV": document.getElementById('content-iptv')
            };

            // Fetch channel data from channels.json
            fetch('channels.json')
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    return response.json();
                })
                .then(channels => {
                    // Validate that the fetched data is an array
                    if (!Array.isArray(channels)) {
                        console.error('Error: Fetched data from channels.json is not an array.');
                        return;
                    }

                    channels.forEach(channel => {
                        // Validate essential properties for each channel
                        if (!channel.category || !channel.data_url || !channel.img_src || !channel.name || !channel.aria_label) {
                            console.warn('Skipping malformed or incomplete channel data:', channel);
                            return; // Skip this channel if data is incomplete
                        }

                        const contentContainer = categoryContentMap[channel.category];
                        if (contentContainer) {
                            const link = document.createElement('a');
                            link.href = "#"; // Use '#' and let JS handle the navigation
                            link.classList.add('channel-link');
                            link.dataset.url = channel.data_url; // Store the actual URL in a data attribute
                            link.setAttribute('aria-label', channel.aria_label);

                            const img = document.createElement('img');
                            img.src = channel.img_src;
                            img.alt = channel.name; // Use channel.name for alt text for accessibility
                            img.loading = "lazy"; // Optimize image loading

                            link.appendChild(img);
                            contentContainer.appendChild(link);
                        } else {
                            console.warn(`No content container found for category: "${channel.category}" for channel: "${channel.name}"`);
                        }
                    });

                    // Use Event Delegation for channel links for better performance
                    // This attaches one listener to the parent instead of many to individual links
                    document.querySelector('main.categories-container').addEventListener('click', function(event) {
                        const link = event.target.closest('.channel-link'); // Find the closest ancestor with class 'channel-link'
                        if (link) {
                            event.preventDefault(); // Prevent default link behavior (e.g., navigating to #)
                            const url = link.dataset.url; // Get the URL from data-url attribute
                            const imgElement = link.querySelector('img');
                            const channelName = imgElement ? imgElement.alt : 'Unknown Channel'; // Get channel name from alt text

                            const categoryElement = link.closest('.category');
                            const categoryButton = categoryElement ? categoryElement.querySelector('.accordion-button') : null;
                            const categoryName = categoryButton ? categoryButton.innerText.trim() : 'Unknown Category'; // Use innerText to get visible text without icons

                            // Send an event to Google Analytics 4 (GA4)
                            if (typeof gtag === 'function') {
                                gtag('event', 'channel_click', {
                                    'channel_name': channelName,
                                    'category': categoryName,
                                    'link_url': url
                                });
                            }

                            // Delay navigation slightly to allow GA4 event to be sent
                            setTimeout(() => {
                                if (url) {
                                    window.location.href = url; // Navigate to the channel URL
                                }
                            }, 200); // 200 milliseconds delay (can be adjusted)
                        }
                    });
                })
                .catch(error => console.error('Error loading channels or processing data:', error));

            // Function to format current date and time
            function formatDateTime(date) {
                const optionsDate = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
                // Removed 'second: '2-digit'' and 'น.' from display part
                const optionsTime = { hour: '2-digit', minute: '2-digit', hour12: false }; // 24-hour format
                const datePart = date.toLocaleDateString('th-TH', optionsDate); // Format date for Thai locale
                const timePart = date.toLocaleTimeString('th-TH', optionsTime); // Format time for Thai locale

                // Removed 'น.' from the display string
                return {
                    display: `${datePart} ${timePart}`, // Display format without 'น.'
                    iso: date.toISOString() // ISO format for datetime attribute
                };
            }

            // Function to update the date and time display
            function updateDateTime() {
                const now = new Date();
                const formatted = formatDateTime(now);
                datetimeDisplay.textContent = formatted.display;
                datetimeDisplay.setAttribute('datetime', formatted.iso); // Set datetime attribute for machine readability
            }

            // Update date and time immediately on page load
            updateDateTime();
            // Update date and time every second
            setInterval(updateDateTime, 1000);

            // Attach a single 'transitionend' listener to each accordion-content element
            // to manage display property after transitions
            document.querySelectorAll('.accordion-content').forEach(contentElement => {
                contentElement.addEventListener('transitionend', function() {
                    // Hide the content completely (display: none) only if it's supposed to be closed
                    // and its maxHeight has transitioned to 0
                    if (!this.classList.contains('show') && this.style.maxHeight === '0px') {
                        this.style.display = 'none';
                    }
                });
            });

            // Function to close an accordion content panel
            function closeAccordion(contentElement, buttonElement) {
                contentElement.classList.remove('show'); // Remove 'show' class to trigger CSS transition
                contentElement.style.maxHeight = '0'; // Set max-height to 0 to collapse
                buttonElement.setAttribute('aria-expanded', 'false'); // Update ARIA attribute for accessibility
            }

            // Function to open an accordion content panel
            function openAccordion(contentElement, buttonElement) {
                contentElement.style.display = 'flex'; // Make content visible for scrollHeight calculation
                buttonElement.setAttribute('aria-expanded', 'true'); // Update ARIA attribute for accessibility

                // Use requestAnimationFrame to ensure CSS display property has been applied
                // before calculating scrollHeight for smooth transition
                requestAnimationFrame(() => {
                    const actualContentHeight = contentElement.scrollHeight; // Get the full height of content
                    // Set max-height to the actual content height plus padding (8px top + 8px bottom = 16px)
                    contentElement.style.maxHeight = (actualContentHeight + 16) + 'px';
                    contentElement.classList.add('show'); // Add 'show' class to apply final styles
                });
            }

            // Get all accordion buttons on the page
            const allAccordionButtons = document.querySelectorAll('.accordion-button');

            allAccordionButtons.forEach(button => {
                const content = button.nextElementSibling; // The content panel immediately following the button

                const categoryElement = button.closest('.category');
                if (categoryElement) {
                    // Adjusted transition to only include properties that are dynamically changed via CSS/JS
                    categoryElement.style.transition = 'background-color 0.3s ease, border-color 0.3s ease';
                }

                // Add click event listener to each accordion button
                button.addEventListener('click', function() {
                    // Close other open accordions
                    allAccordionButtons.forEach(otherButton => {
                        const otherContent = otherButton.nextElementSibling;
                        if (otherButton !== this && otherContent && otherContent.classList.contains('show')) {
                            closeAccordion(otherContent, otherButton);
                        }
                    });

                    // Toggle the clicked accordion
                    if (content && content.classList.contains('show')) {
                        closeAccordion(content, this);
                    } else if (content) {
                        openAccordion(content, this);
                    }
                });
            });

            // Prevent right-click context menu
            document.addEventListener('contextmenu', function(e) {
                e.preventDefault();
            });

            // Prevent certain keyboard shortcuts (e.g., Ctrl+C, Ctrl+V, F12)
            document.addEventListener('keydown', function(e) {
                // Allow Spacebar and Enter to function normally (for accessibility)
                if (e.key === ' ' || e.key === 'Enter') {
                    return;
                }
                // Prevent common copy/paste/view source shortcuts
                if (e.ctrlKey && (e.key === 'c' || e.key === 'x' || e.key === 'v' || e.key === 'u')) {
                    e.preventDefault();
                }
                // Prevent F12 (developer tools)
                if (e.key === 'F12') {
                    e.preventDefault();
                }
            });
        });
    </script>
</body>
</html>
